package ed448

import (
	. "gopkg.in/check.v1"
)

func (s *Ed448Suite) Test_PointFromNonUniformHash(c *C) {
	ser := [56]byte{
		0x0d, 0xc3, 0x50, 0x83, 0xbd, 0x0d, 0x55, 0xd3,
		0xdd, 0x8c, 0x50, 0x28, 0x1c, 0x32, 0x77, 0x7e,
		0x62, 0x03, 0x82, 0xa3, 0x18, 0x72, 0xc1, 0x7b,
		0xc2, 0x69, 0x11, 0xb7, 0x34, 0xbd, 0x2b, 0xc4,
		0x26, 0x3b, 0x82, 0xc2, 0x12, 0x3c, 0x2a, 0x3c,
		0xe7, 0x49, 0x3c, 0x21, 0xfb, 0xb2, 0xb5, 0xe2,
		0x41, 0xa8, 0xce, 0xa6, 0xb7, 0xf1, 0xc1, 0x3f,
	}

	exp := &twExtendedPoint{
		&bigNumber{
			0x5e7810c, 0x6a19e19, 0xe635cc4, 0xdbd59a2,
			0x4fce20e, 0x6da3784, 0xf1b9230, 0x35bf9c2,
			0xfa6b68, 0xcdeb50f, 0x3311d6c, 0x1a8afdc,
			0xe3d501b, 0x39bf41e, 0xa254d1, 0xa445f54,
		},
		&bigNumber{
			0x2a278a, 0xf22d94c, 0x565a04c, 0x45a4427,
			0x74d5449, 0x59376c, 0x9e268f1, 0x26a321b,
			0x2ed2cd4, 0xb865c1f, 0xb639168, 0xd1a1d75,
			0xfa0e7e5, 0x77964a8, 0xaf0ecf3, 0xc571e8a,
		},
		&bigNumber{
			0x5589192, 0xae2f114, 0xcb8c7aa, 0x25be34a,
			0x6ad85d9, 0x2769636, 0xabe8e7f, 0xac50191,
			0xba9ef42, 0x97bcc24, 0x2281380, 0x9d226ab,
			0x47e6ff6, 0x9401288, 0x33158d1, 0x57ce885,
		},

		&bigNumber{
			0xf6ed34, 0x348f511, 0xb0c0382, 0xb649816,
			0xcc652a, 0x7a09944, 0xa1a6592, 0x30c2cf,
			0xbfcac7e, 0x1993fb6, 0x6a6bfff, 0x12f6f1e,
			0xbd57bd0, 0x508938c, 0xb51f004, 0x1a123,
		},
	}
	p := pointFromNonUniformHash(ser)
	c.Assert(p.x, DeepEquals, exp.x)
	c.Assert(p.y, DeepEquals, exp.y)
	c.Assert(p.z, DeepEquals, exp.z)
	c.Assert(p.t, DeepEquals, exp.t)
}
